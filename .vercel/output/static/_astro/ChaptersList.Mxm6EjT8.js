import{j as e}from"./jsx-runtime.B-tYHWOS.js";import{r as s}from"./index.BCPtUIm2.js";import{a as X,u as ee}from"./useChapterStore.BIfqi0n6.js";import{c as y,O as ae,P as te,W as re,C as oe,T as se,D as le,a as A,R as ie,b as ne,A as ce,d as de,e as pe,f as me}from"./index.CBFvVGSl.js";import{u as N,S as ue,c as m,b as D,B as v}from"./button.DSwAMVRZ.js";import{G as j}from"./iconBase.wJcibKWI.js";import{_ as x}from"./index.BInd9SeV.js";import{c as ge,a as fe}from"./index.CkCWt44i.js";import"./supabase.YDNJ6__1.js";import"./index.Bk4Tk5ow.js";import"./react.BoqmBW-A.js";import"./index.D1eIsul2.js";function xe(a){return j({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-8.4 8.4a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32l8.4-8.4Z"},child:[]},{tag:"path",attr:{d:"M5.25 5.25a3 3 0 0 0-3 3v10.5a3 3 0 0 0 3 3h10.5a3 3 0 0 0 3-3V13.5a.75.75 0 0 0-1.5 0v5.25a1.5 1.5 0 0 1-1.5 1.5H5.25a1.5 1.5 0 0 1-1.5-1.5V8.25a1.5 1.5 0 0 1 1.5-1.5h5.25a.75.75 0 0 0 0-1.5H5.25Z"},child:[]}]})(a)}function he(a){return j({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M16.5 4.478v.227a48.816 48.816 0 0 1 3.878.512.75.75 0 1 1-.256 1.478l-.209-.035-1.005 13.07a3 3 0 0 1-2.991 2.77H8.084a3 3 0 0 1-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 0 1-.256-1.478A48.567 48.567 0 0 1 7.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 0 1 3.369 0c1.603.051 2.815 1.387 2.815 2.951Zm-6.136-1.452a51.196 51.196 0 0 1 3.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 0 0-6 0v-.113c0-.794.609-1.428 1.364-1.452Zm-.355 5.945a.75.75 0 1 0-1.5.058l.347 9a.75.75 0 1 0 1.499-.058l-.346-9Zm5.48.058a.75.75 0 1 0-1.498-.058l-.347 9a.75.75 0 0 0 1.5.058l.345-9Z",clipRule:"evenodd"},child:[]}]})(a)}var C="AlertDialog",[ve,ze]=ge(C,[y]),c=y(),b=a=>{const{__scopeAlertDialog:t,...r}=a,o=c(t);return e.jsx(ie,{...o,...r,modal:!0})};b.displayName=C;var ye="AlertDialogTrigger",Ae=s.forwardRef((a,t)=>{const{__scopeAlertDialog:r,...o}=a,l=c(r);return e.jsx(ne,{...l,...o,ref:t})});Ae.displayName=ye;var Ne="AlertDialogPortal",w=a=>{const{__scopeAlertDialog:t,...r}=a,o=c(t);return e.jsx(te,{...o,...r})};w.displayName=Ne;var De="AlertDialogOverlay",S=s.forwardRef((a,t)=>{const{__scopeAlertDialog:r,...o}=a,l=c(r);return e.jsx(ae,{...l,...o,ref:t})});S.displayName=De;var g="AlertDialogContent",[je,Ce]=ve(g),R=s.forwardRef((a,t)=>{const{__scopeAlertDialog:r,children:o,...l}=a,f=c(r),d=s.useRef(null),h=N(t,d),u=s.useRef(null);return e.jsx(re,{contentName:g,titleName:_,docsSlug:"alert-dialog",children:e.jsx(je,{scope:r,cancelRef:u,children:e.jsxs(oe,{role:"alertdialog",...f,...l,ref:h,onOpenAutoFocus:fe(l.onOpenAutoFocus,n=>{n.preventDefault(),u.current?.focus({preventScroll:!0})}),onPointerDownOutside:n=>n.preventDefault(),onInteractOutside:n=>n.preventDefault(),children:[e.jsx(ue,{children:o}),e.jsx(we,{contentRef:d})]})})})});R.displayName=g;var _="AlertDialogTitle",E=s.forwardRef((a,t)=>{const{__scopeAlertDialog:r,...o}=a,l=c(r);return e.jsx(se,{...l,...o,ref:t})});E.displayName=_;var T="AlertDialogDescription",P=s.forwardRef((a,t)=>{const{__scopeAlertDialog:r,...o}=a,l=c(r);return e.jsx(le,{...l,...o,ref:t})});P.displayName=T;var be="AlertDialogAction",O=s.forwardRef((a,t)=>{const{__scopeAlertDialog:r,...o}=a,l=c(r);return e.jsx(A,{...l,...o,ref:t})});O.displayName=be;var M="AlertDialogCancel",$=s.forwardRef((a,t)=>{const{__scopeAlertDialog:r,...o}=a,{cancelRef:l}=Ce(M,r),f=c(r),d=N(t,l);return e.jsx(A,{...f,...o,ref:d})});$.displayName=M;var we=({contentRef:a})=>{const t=`\`${g}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${g}\` by passing a \`${T}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${g}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return s.useEffect(()=>{document.getElementById(a.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,a]),null},Se=b,Re=w,I=S,F=R,H=O,L=$,k=E,G=P;const _e=Se,Ee=Re,Z=s.forwardRef(({className:a,...t},r)=>e.jsx(I,{className:m("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...t,ref:r}));Z.displayName=I.displayName;const B=s.forwardRef(({className:a,...t},r)=>e.jsxs(Ee,{children:[e.jsx(Z,{}),e.jsx(F,{ref:r,className:m("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...t})]}));B.displayName=F.displayName;const z=({className:a,...t})=>e.jsx("div",{className:m("flex flex-col space-y-2 text-center sm:text-left",a),...t});z.displayName="AlertDialogHeader";const V=({className:a,...t})=>e.jsx("div",{className:m("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t});V.displayName="AlertDialogFooter";const W=s.forwardRef(({className:a,...t},r)=>e.jsx(k,{ref:r,className:m("text-lg font-semibold",a),...t}));W.displayName=k.displayName;const q=s.forwardRef(({className:a,...t},r)=>e.jsx(G,{ref:r,className:m("text-sm text-muted-foreground",a),...t}));q.displayName=G.displayName;const Y=s.forwardRef(({className:a,...t},r)=>e.jsx(H,{ref:r,className:m(D(),a),...t}));Y.displayName=H.displayName;const J=s.forwardRef(({className:a,...t},r)=>e.jsx(L,{ref:r,className:m(D({variant:"outline"}),"mt-2 sm:mt-0",a),...t}));J.displayName=L.displayName;function Ve({storyId:a}){const{data:t,error:r,isLoading:o}=X(a),{updateChapter:l,deleteChapter:f}=ee(),[d,h]=s.useState(null),[u,n]=s.useState(null),K=async(i,p)=>{try{await l(i,{summary:p}),h(null),x.success("Summary updated")}catch{x.error("Failed to update summary")}},Q=async i=>{try{await f(i,a),x.success("Chapter deleted"),n(null)}catch{x.error("Failed to delete chapter")}},U=async i=>{x.success("Summary generation coming soon!")};return o?e.jsx("div",{className:"text-center py-8",children:"Loading chapters..."}):r?e.jsxs("div",{className:"text-red-500",children:["Error: ",r]}):t.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No chapters yet. Create your first chapter above!"}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{type:"single",collapsible:!0,className:"space-y-4",children:t.map(i=>e.jsxs(de,{value:i.id,className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx(pe,{className:"px-6 hover:no-underline",children:e.jsxs("div",{className:"flex items-center justify-between flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold",children:i.title}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("a",{href:`/story/${a}/chapter/${i.id}`,className:"p-2 text-gray-500 hover:text-gray-700",onClick:p=>p.stopPropagation(),children:e.jsx(xe,{className:"h-5 w-5"})}),e.jsx("div",{onClick:p=>{p.stopPropagation(),n(i.id)},className:"p-2 mr-3 text-gray-500 hover:text-red-600 cursor-pointer",children:e.jsx(he,{className:"h-5 w-5"})})]})]})}),e.jsx(me,{className:"px-6 pb-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("textarea",{value:d??i.summary??"",onChange:p=>h(p.target.value),placeholder:"Enter chapter summary...",className:`w-full min-h-[100px] p-3 rounded-md border border-gray-300 
                           focus:border-blue-500 focus:ring-1 focus:ring-blue-500`}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx(v,{onClick:()=>U(i.id),variant:"outline",children:"Generate Summary"}),e.jsx(v,{onClick:()=>K(i.id,d||""),disabled:d===i.summary,children:"Save Summary"})]})]})})]},i.id))}),e.jsx(_e,{open:!!u,onOpenChange:()=>n(null),children:e.jsxs(B,{className:"bg-white",children:[e.jsxs(z,{children:[e.jsx(W,{children:"Are you sure?"}),e.jsx(q,{children:"This action cannot be undone. This will permanently delete the chapter."})]}),e.jsxs(V,{children:[e.jsx(J,{children:"Cancel"}),e.jsx(Y,{onClick:()=>u&&Q(u),className:"bg-red-600 hover:bg-red-700 text-white",children:"Delete"})]})]})})]})}export{Ve as default};
